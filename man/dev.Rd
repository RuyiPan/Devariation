% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/devariation.R
\name{dev}
\alias{dev}
\title{Devariation-adjusted data via low-rank extraction}
\usage{
dev(X, lambda = NULL)
}
\arguments{
\item{X}{A numeric matrix (e.g., observed data containing structured signal and noise).}

\item{lambda}{Optional nonnegative tuning parameter controlling the strength of
devariation (how much dominant structure is removed). If \code{NULL}, the
function estimates \code{tauX} and sets
\eqn{\lambda = \tau_X(\sqrt{n} + \sqrt{p})}.}
}
\value{
A list with the following components:
\describe{
  \item{dX}{The devariation-adjusted data matrix, defined as \code{dX = X - S}.}
  \item{lambda}{The tuning parameter used for devariation.}
  \item{tauX}{Estimated noise scale. If \code{lambda} is supplied, \code{tauX = lambda / (\sqrt{n} + \sqrt{p})}.}
}
}
\description{
Constructs the devariation-adjusted data by separating the observed matrix
into (i) a dominant structured component and (ii) a residual
component. The residual is interpreted as the
devariation-adjusted data, where large-scale structured variation is removed.
}
\details{
The structured component \code{S} is obtained by extracting dominant
low-rank variation from \code{X}. If \code{lambda} is not provided, it is
set using an estimated noise scale \code{tauX} (via \code{estim_sigma()})
and the high-dimensional scaling factor \eqn{\sqrt{n} + \sqrt{p}} for an
\eqn{n \times p} matrix \code{X}.
}
\examples{
set.seed(1)
X <- matrix(rnorm(100 * 80), 100, 80)
out <- dev(X)
dim(out$dX)

# User-specified devariation strength
out2 <- dev(X, lambda = 5)

}
